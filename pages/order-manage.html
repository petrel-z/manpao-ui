<!-- 订单管理 -->
<div class="page" id="order-manage">
    <div class="min-h-full bg-gray-50 pb-20">
        <!-- 头部导航 -->
        <div class="primary-red p-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-3">
                    <i onclick="showPage('my-store')" class="fas fa-arrow-left text-white cursor-pointer"></i>
                    <h1 class="text-white text-lg font-medium">订单管理</h1>
                </div>
                <!-- <div class="flex items-center space-x-3">
                    <button onclick="exportOrders()" class="bg-white bg-opacity-20 text-white px-3 py-1.5 rounded-full text-sm font-medium">
                        <i class="fas fa-download mr-1"></i>导出
                    </button>
                </div> -->
            </div>
        </div>

        <!-- 搜索框 -->
        <div class="px-4 flex">
            <div class="bg-white rounded-lg p-3">
                <div class="relative">
                    <input type="text" id="searchInput" placeholder="搜索订单号、商品名..." 
                           class="w-full pr-10 pl-4 py-2.5 border border-gray-200 rounded-lg text-sm focus:outline-none focus:border-red-500"
                           oninput="searchOrders()">
                    <i class="fas fa-search absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                </div>
            </div>
             <div class="flex w-[30%] items-center space-x-3 bg-white rounded-lg p-3 pl-0">
                <select id="timeFilter" class="flex-1 p-2 border border-gray-200 rounded-lg text-sm w-full" onchange="filterOrders()">
                    <option value="all">筛选</option>
                    <option value="today">今天</option>
                    <option value="week">近一周</option>
                    <option value="month">近一月</option>
                    <option value="quarter">近三月</option>
                    <option value="custom">具体时间</option>
                </select>
            </div>
        </div>

        <!-- 订单分类 -->
        <div class="p-4">
            <div class="grid grid-cols-5 gap-1">
                <div class="bg-white rounded-lg p-3 text-center">
                    <div class="text-xl font-bold text-blue-500">18</div>
                    <div class="text-xs text-gray-500" style="font-size: 10px;">全部</div>
                </div>
                <div class="bg-white rounded-lg p-3 text-center">
                    <div class="text-xl font-bold text-blue-500">8</div>
                    <div class="text-xs text-gray-500" style="font-size: 10px;">待使用</div>
                </div>
                <div class="bg-white rounded-lg p-3 text-center">
                    <div class="text-xl font-bold text-green-500">25</div>
                    <div class="text-xs text-gray-500" style="font-size: 10px;">已使用</div>
                </div>
                <div class="bg-white rounded-lg p-3 text-center">
                    <div class="text-xl font-bold text-red-500">2</div>
                    <div class="text-xs text-gray-500" style="font-size: 10px;">已退款</div>
                </div>
                <div class="bg-white rounded-lg p-3 text-center">
                    <div class="text-xl font-bold text-gray-500">1</div>
                    <div class="text-xs text-gray-500" style="font-size: 10px;">已取消</div>
                </div>
            </div>
        </div>

        <!-- 订单列表 -->
        <div class="px-4 space-y-3 h-[477px] overflow-y-auto" id="orderList">
            <!-- 订单项 1 - 待核销 -->
            <div class="bg-white rounded-lg p-4 order-item" data-status="pending">
                <div class="flex flex-col items-start justify-between mb-3">
                    <div class="w-full flex items-center justify-between space-x-2 mb-2">
                        <span class="text-sm font-medium text-gray-800">订单号: TG202412150001</span>
                        <span class="bg-blue-100 text-blue-600 px-2 py-1 rounded-full text-xs">待使用</span>
                    </div>
                    <div class="flex w-full items-center justify-between">
                        <div class="flex-1">
                            <div class="text-xs text-gray-500 mb-1">下单时间: 2024-12-15 14:30</div>
                            <div class="text-xs text-gray-500">有效期至: 2024-12-22 23:59</div>
                        </div>
                        <div class="text-right">
                             <div class="text-xs text-gray-500">实付:</div>
                             <div class="text-lg font-bold text-red-500">¥28.8</div>
                             <div class="text-xs text-gray-500">数量: 1</div>
                        </div>
                    </div>
                </div>
                
                <div class="border-t border-gray-100 pt-3">
                    <div class="flex items-center space-x-3 mb-3">
                        <img src="https://images.unsplash.com/photo-1551024506-0bccd828d307?w=50&h=50&fit=crop" 
                             alt="商品图片" class="w-12 h-12 rounded-lg object-cover">
                        <div class="flex-1">
                            <h4 class="text-sm font-medium text-gray-800">香辣鸡腿堡套餐</h4>
                            <p class="text-xs text-gray-500">规格: 中辣 + 薯条 + 可乐</p>
                        </div>
                    </div>
                    
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-2">
                            <i class="fas fa-user text-gray-400 text-xs"></i>
                            <span class="text-xs text-gray-600">张三 (138****5678)</span>
                        </div>
                        <div class="flex space-x-2">
                            <button onclick="showVerifyModal('TG202412150001')" class="bg-green-500 text-white px-3 py-1.5 rounded-lg text-xs font-medium">
                                <i class="fas fa-check mr-1"></i>核销
                            </button>
                            <button onclick="showOrderDetail('TG202412150001')" class="bg-gray-100 text-gray-600 px-3 py-1.5 rounded-lg text-xs">
                                详情
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 订单项 2 - 已核销 -->
            <div class="bg-white rounded-lg p-4 order-item" data-status="verified">
                <div class="flex flex-col items-start justify-between mb-3">
                    <div class="w-full flex items-center justify-between space-x-2 mb-2">
                        <span class="text-sm font-medium text-gray-800">订单号: TG202412150002</span>
                        <span class="bg-green-100 text-green-600 px-2 py-1 rounded-full text-xs">已使用</span>
                    </div>
                    <div class="flex w-full items-center justify-between">
                        <div class="flex-1">
                            <div class="text-xs text-gray-500 mb-1">下单时间: 2024-12-15 12:15</div>
                            <div class="text-xs text-gray-500">核销时间: 2024-12-15 18:30</div>
                        </div>
                        <div class="text-right">
                             <div class="text-xs text-gray-500">实付:</div>
                             <div class="text-lg font-bold text-red-500">¥12.0</div>
                             <div class="text-xs text-gray-500">数量: 2</div>
                        </div>
                    </div>
                </div>
                
                <div class="border-t border-gray-100 pt-3">
                    <div class="flex items-center space-x-3 mb-3">
                        <img src="https://images.unsplash.com/photo-1551024506-0bccd828d307?w=50&h=50&fit=crop" 
                             alt="商品图片" class="w-12 h-12 rounded-lg object-cover">
                        <div class="flex-1">
                            <h4 class="text-sm font-medium text-gray-800">珍珠奶茶</h4>
                            <p class="text-xs text-gray-500">规格: 大杯 + 正常糖 + 去冰</p>
                        </div>
                    </div>
                    
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-2">
                            <i class="fas fa-user text-gray-400 text-xs"></i>
                            <span class="text-xs text-gray-600">李四 (139****1234)</span>
                        </div>
                        <div class="flex space-x-2">
                            <button onclick="showOrderDetail('TG202412150002')" class="bg-gray-100 text-gray-600 px-3 py-1.5 rounded-lg text-xs">
                                详情
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 订单项 3 - 已退款 -->
            <div class="bg-white rounded-lg p-4 order-item" data-status="refunded">
                <div class="flex flex-col items-start justify-between mb-3">
                    <div class="w-full flex items-center justify-between space-x-2 mb-2">
                        <span class="text-sm font-medium text-gray-800">订单号: TG202412140003</span>
                        <span class="bg-red-100 text-red-600 px-2 py-1 rounded-full text-xs">已退款</span>
                    </div>
                    <div class="flex w-full items-center justify-between">
                        <div class="flex-1">
                            <div class="text-xs text-gray-500 mb-1">下单时间: 2024-12-14 16:45</div>
                            <div class="text-xs text-gray-500">退款时间: 2024-12-14 20:10</div>
                        </div>
                        <div class="text-right">
                             <div class="text-xs text-gray-500">实付:</div>
                             <div class="text-lg font-bold text-gray-400">¥15.5</div>
                             <div class="text-xs text-gray-500">数量: 1</div>
                        </div>
                    </div>
                </div>
                
                <div class="border-t border-gray-100 pt-3">
                    <div class="flex items-center space-x-3 mb-3">
                        <img src="https://images.unsplash.com/photo-1546069901-ba9599a7e63c?w=50&h=50&fit=crop" 
                             alt="商品图片" class="w-12 h-12 rounded-lg object-cover">
                        <div class="flex-1">
                            <h4 class="text-sm font-medium text-gray-800">芝士蛋糕</h4>
                            <p class="text-xs text-gray-500">规格: 6寸 + 草莓口味</p>
                        </div>
                    </div>
                    
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-2">
                            <i class="fas fa-user text-gray-400 text-xs"></i>
                            <span class="text-xs text-gray-600">王五 (137****9876)</span>
                        </div>
                        <div class="flex space-x-2">
                            <button onclick="showOrderDetail('TG202412140003')" class="bg-gray-100 text-gray-600 px-3 py-1.5 rounded-lg text-xs">
                                详情
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 订单项 4 - 已取消 -->
            <div class="bg-white rounded-lg p-4 order-item" data-status="cancelled">
                <div class="flex flex-col items-start justify-between mb-3">
                    <div class="w-full flex items-center justify-between space-x-2 mb-2">
                        <span class="text-sm font-medium text-gray-800">订单号: TG202412130004</span>
                        <span class="bg-gray-100 text-gray-600 px-2 py-1 rounded-full text-xs">已取消</span>
                    </div>
                    <div class="flex w-full items-center justify-between">
                        <div class="flex-1">
                            <div class="text-xs text-gray-500 mb-1">下单时间: 2024-12-13 10:20</div>
                            <div class="text-xs text-gray-500">取消时间: 2024-12-13 10:35</div>
                        </div>
                        <div class="text-right">
                             <div class="text-xs text-gray-500">实付:</div>
                             <div class="text-lg font-bold text-gray-400">¥22.5</div>
                             <div class="text-xs text-gray-500">数量: 1</div>
                        </div>
                    </div>
                </div>
                
                <div class="border-t border-gray-100 pt-3">
                    <div class="flex items-center space-x-3 mb-3">
                        <img src="https://images.unsplash.com/photo-1565299624946-b28f40a0ca4b?w=50&h=50&fit=crop" 
                             alt="商品图片" class="w-12 h-12 rounded-lg object-cover">
                        <div class="flex-1">
                            <h4 class="text-sm font-medium text-gray-800">意式披萨</h4>
                            <p class="text-xs text-gray-500">规格: 9寸 + 培根 + 芝士</p>
                        </div>
                    </div>
                    
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-2">
                            <i class="fas fa-user text-gray-400 text-xs"></i>
                            <span class="text-xs text-gray-600">赵六 (136****5432)</span>
                        </div>
                        <div class="flex space-x-2">
                            <button onclick="showOrderDetail('TG202412130004')" class="bg-gray-100 text-gray-600 px-3 py-1.5 rounded-lg text-xs">
                                详情
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 核销确认弹窗 -->
    <div id="verifyModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
        <div class="flex items-center justify-center h-full p-4">
            <div class="bg-white rounded-lg p-6 w-full max-w-sm">
                <div class="text-center mb-4">
                    <i class="fas fa-qrcode text-4xl text-blue-500 mb-3"></i>
                    <h3 class="text-lg font-medium text-gray-800 mb-2">订单核销</h3>
                    <p class="text-sm text-gray-600">请确认顾客出示的核销码</p>
                </div>
                
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">核销码</label>
                    <input type="text" id="verifyCode" placeholder="请输入6位核销码" 
                           class="w-full p-3 border border-gray-300 rounded-lg text-center text-lg font-mono" 
                           maxlength="6">
                </div>
                
                <div class="flex space-x-3">
                    <button onclick="closeVerifyModal()" class="flex-1 bg-gray-100 text-gray-600 py-3 rounded-lg font-medium">
                        取消
                    </button>
                    <button onclick="confirmVerify()" class="flex-1 bg-green-500 text-white py-3 rounded-lg font-medium">
                        确认核销
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- 订单详情弹窗 -->
    <div id="orderDetailModal" class="absolute w-full h-[740px] top-0 left-0 inset-0 bg-black bg-opacity-50 z-50 hidden">
        <div class="flex items-center justify-center h-full p-4">
            <div class="bg-white rounded-lg w-full max-w-md max-h-[70%] overflow-y-auto">
                <!-- 弹窗头部 -->
                <div class="sticky top-0 bg-white border-b border-gray-200 p-4 flex items-center justify-between">
                    <h3 class="text-lg font-medium text-gray-800">订单详情</h3>
                    <button onclick="hideOrderDetail()" class="text-gray-400 hover:text-gray-600">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
                
                <!-- 弹窗内容 -->
                <div class="p-4">
                    <!-- 订单备注 - 显眼位置 -->
                    <div class="mb-4 p-3 bg-yellow-50 border-l-4 border-yellow-400 rounded-r-lg">
                        <div class="flex items-center mb-1">
                            <i class="fas fa-sticky-note text-yellow-600 text-sm mr-2"></i>
                            <span class="text-sm font-medium text-yellow-800">订单备注</span>
                        </div>
                        <p class="text-sm text-yellow-700" id="detailOrderNote">无</p>
                    </div>

                    <!-- 订单基本信息 -->
                    <div class="mb-6">
                        <div class="flex items-center justify-between mb-3">
                            <span class="text-sm font-medium text-gray-800">订单号: <span id="detailOrderId"></span></span>
                            <span id="detailStatus" class="px-2 py-1 rounded-full text-xs"></span>
                        </div>
                        
                        <div class="flex items-center justify-between">
                            <div class="flex-1">
                                <div class="text-xs text-gray-500 mb-1">下单时间: <span id="detailOrderTime"></span></div>
                                <div id="detailTimeInfo"></div>
                            </div>
                            <div class="text-right">
                                <div class="text-xs text-gray-500">原价:</div>
                                <div class="text-sm text-gray-400 line-through" id="detailOriginalAmount"></div>
                                <div class="text-xs text-gray-500 mt-1">实付:</div>
                                <div class="text-lg font-bold text-red-500" id="detailAmount"></div>
                                <div class="text-xs text-gray-500">数量: <span id="detailQuantity"></span></div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 商品信息 -->
                    <div class="border-t border-gray-100 pt-4 mb-6">
                        <h4 class="text-sm font-medium text-gray-800 mb-3">商品信息</h4>
                        <div class="flex items-center space-x-3">
                            <img id="detailProductImage" alt="商品图片" class="w-16 h-16 rounded-lg object-cover">
                            <div class="flex-1">
                                <h5 class="text-sm font-medium text-gray-800" id="detailProductName"></h5>
                                <p class="text-xs text-gray-500" id="detailProductSpec"></p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 顾客信息 -->
                    <div class="border-t border-gray-100 pt-4 mb-6">
                        <h4 class="text-sm font-medium text-gray-800 mb-3">顾客信息</h4>
                        <div class="space-y-2">
                            <div class="flex items-center space-x-2">
                                <i class="fas fa-user text-gray-400 text-xs w-4"></i>
                                <span class="text-xs text-gray-600" id="detailCustomerName"></span>
                                <span class="text-xs text-gray-600" id="detailCustomerPhone"></span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 订单详细信息 -->
                    <div class="border-t border-gray-100 pt-4 mb-6">
                        <h4 class="text-sm font-medium text-gray-800 mb-3">订单信息</h4>
                        <div class="space-y-3">
                            <div class="flex justify-between">
                                <span class="text-xs text-gray-500">支付方式:</span>
                                <span class="text-xs text-gray-800" id="detailPaymentMethod"></span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-xs text-gray-500">商家名称:</span>
                                <span class="text-xs text-gray-800" id="detailMerchantName"></span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 弹窗底部 -->
                <div class="sticky bottom-0 bg-white border-t border-gray-200 p-4">
                    <button onclick="hideOrderDetail()" class="w-full bg-gray-100 text-gray-600 py-3 rounded-lg font-medium">
                        关闭
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

